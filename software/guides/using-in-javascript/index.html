<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Using in JavaScript | MyGeotab SDK</title><meta name=generator content="Jekyll v3.6.2"><meta property=og:title content="Using in JavaScript"><meta name=author content="The Geotab Team"><meta property=og:locale content=en_US><meta name=description content="The Geotab SDK (Software Development Kit) is a powerful set of tools for automating tasks and working with the data in MyGeotab. Within these documents you will find information on how to develop JavaScript and C# applications, build and integrate Add-Ins and use MyGeotab with third-party systems."><meta property=og:description content="The Geotab SDK (Software Development Kit) is a powerful set of tools for automating tasks and working with the data in MyGeotab. Within these documents you will find information on how to develop JavaScript and C# applications, build and integrate Add-Ins and use MyGeotab with third-party systems."><link rel=canonical href=https://geotab.github.io/sdk/software/guides/using-in-javascript/ ><meta property=og:url content=https://geotab.github.io/sdk/software/guides/using-in-javascript/ ><meta property=og:site_name content="MyGeotab SDK"><script type=application/ld+json>{"description":"The Geotab SDK (Software Development Kit) is a powerful set of tools for automating tasks and working with the data in MyGeotab. Within these documents you will find information on how to develop JavaScript and C# applications, build and integrate Add-Ins and use MyGeotab with third-party systems.","author":{"@type":"Person","name":"The Geotab Team"},"@type":"WebPage","url":"https://geotab.github.io/sdk/software/guides/using-in-javascript/","headline":"Using in JavaScript","@context":"http://schema.org"}</script><link rel=stylesheet href=/sdk/assets/stylesheets/style-337c2e691b.min.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/sdk/assets/images/touch/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/sdk/assets/favicon.ico></head><body><header><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class=navbar-brand href=/sdk/ ><img src=/sdk/assets/images/pillar.svg width=30 height=30 class="d-inline-block align-top" alt=""> MyGeotab SDK </a><button class="navbar-toggler d-lg-none" type=button><span class=navbar-toggler-icon></span></button></nav></header><div class=container-fluid><div class=row><nav class="col-sm-3 col-md-2 d-none d-sm-block bg-light sidebar"><h4>Software</h4><ul class="nav flex-column"><li class=nav-link><a href=/software/introduction/ >Introduction</a></li><h5>Guides</h5><ul class="nav flex-column"><li class=nav-link><a href=/software/guides/getting-started/ >Getting Started</a></li><li class=nav-link><a href=/software/guides/concepts/ >Concepts</a></li><li class="nav-link active"><a href=/software/guides/using-in-javascript/ >Using in Javascript</a></li><li class=nav-link><a href=/software/guides/using-in-dotnet/ >Using in dotnet</a></li><li class=nav-link><a href=/software/guides/data-feed>Data Feed</a></li><li class=nav-link><a href=/software/guides/mygeotab-urls/ >Using MyGeotab URLs</a></li><li class=nav-link><a href=/software/guides/go-device-logging/ >GO Device Logging</a></li><li class=nav-link><a href=/software/guides/third-party-devices/ >Using Third-Party Devices</a></li><li class=nav-link><a href=/software/guides/developing-addins/ >Devloping Add-Ins</a></li><li class=nav-link><a href=/software/guides/drive-addins/ >Geotab Drive Add-Ins</a></li></ul><h5>API</h5><ul class="nav flex-column"><li class=nav-link><a href=/software/api/reference/ >Reference</a></li><li class=nav-link><a href=/software/api/runner.html>Runner</a></li><li class=nav-link><a href=/software/api/wrappers/ >Wrappers</a></li></ul><h5>Code Samples</h5><ul class="nav flex-column"><li class=nav-link><a href=https://github.com/geotab/js-examples>Javascript Examples</a></li><li class=nav-link><a href=https://github.com/geotab/dotnet-examples>Dotnet Examples</a></li><li class=nav-link><a href=https://github.com/geotab/addin-examples>Add-in Examples</a></li><li class=nav-link><a href=https://github.com/geotab/dotnet-examples/src/data-feed>Data feed example</a></li></ul></ul><h4>Hardware</h4><ul class="nav flex-column"><li class=nav-link><a href=/hardware/introduction/ >Introduction</a></li><h5>Add-on Protocols</h5><ul class="nav flex-column"><li class=nav-link><a href=/hardware/addon-protocols/rs232-usb/ >RS232 & USB</a></li><li class=nav-link><a href=/hardware/addon-protocols/can/ >CAN</a></li><li class=nav-link><a href=/hardware/addon-protocols/ble/ >BLE</a></li></ul><h5>Code Samples</h5><ul class="nav flex-column"><li class=nav-link><a href=/hardware/samples/python/ >Python</a></li><li class=nav-link><a href=https://github.com/Geotab/android-external-device-example>Andoid</a></li></ul><h5>Developing an IOX</h5><ul class="nav flex-column"><li class=nav-link><a href=/hardware/developing-an-iox/hardware-design-guide/ >Hardware Design Guide</a></li><li class=nav-link><a href=/hardware/developing-an-iox/messaging-protocol/ >Messaging Protocol</a></li></ul></ul><h4>Resources</h4><ul class="nav flex-column"><li class=nav-link><a href=https://helpdesk.geotab.com/hc/en-us/community/topics/200655183-SDK-Forum>Forums</a></li><li class=nav-link><a href=https://www.geotab.com/dev-channel/ >Dev Channel</a></li><li class=nav-link><a href=/resources/new/ >What's New</a></li></ul></nav><main role=main class="col-sm-9 ml-sm-auto col-md-10 pt-3"><article class=col-md-12><header><h1>Using in JavaScript</h1></header><div><h2 id=geotabapi-object>GeotabApi object</h2><p>Geotab provides JavaScript developers with easy to use and consistent access to our API through the <a href=https://github.com/Geotab/mg-api-js>GeotabApi</a> object. The GeotabAPI provides authentication handling, asynchronous method calling, error handling and multi-call support.</p><blockquote><p>See how to install GeotabAPI in <a href=/software/api/wrappers/#javascript>API Wrappers</a></p></blockquote><h2 id=creating-a-geotabapi-object>Creating a GeotabApi object</h2><p>When creating the GeotabApi object, prepend a reference to the file <em>api.js</em> before the main JavaScript code:</p><div class=highlight><pre><code class=language-html data-lang=html><span class=nt>&lt;script </span><span class=na>type=</span><span class=s>"text/javascript"</span> <span class=na>src=</span><span class=s>"api.js"</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>type=</span><span class=s>"text/javascript"</span><span class=nt>&gt;</span>
    <span class=c1>// Custom code goes here</span>
<span class=nt>&lt;/script&gt;</span>
</code></pre></div><p>In the main JavaScript code, initialize the GeotabApi object by providing the constructor with a callback function to handle the authentication:</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=kd>var</span> <span class=nx>api</span> <span class=o>=</span> <span class=nx>GeotabApi</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>authenticationCallback</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// Handling getting credentials. Deals with these cases:</span>
    <span class=c1>//      a) No credentials yet (first page load)</span>
    <span class=c1>//      b) The credentials have expired (password changed or server moved)</span>
    <span class=c1>//      c) "api.forget()" has been called</span>
    <span class=c1>//</span>
    <span class=c1>// Show the dialog now &amp; set up listener to callback with credentials</span>
    <span class=c1>//</span>
    <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>"submit"</span><span class=p>).</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>"click"</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
        <span class=kd>var</span>
        <span class=nx>server</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>"server"</span><span class=p>).</span><span class=nx>value</span><span class=p>,</span>
        <span class=nx>userName</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>"username"</span><span class=p>).</span><span class=nx>value</span><span class=p>,</span>
        <span class=nx>password</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>"password"</span><span class=p>).</span><span class=nx>value</span><span class=p>,</span>
        <span class=nx>database</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>"database"</span><span class=p>).</span><span class=nx>value</span><span class=p>;</span>

        <span class=nx>authenticationCallback</span><span class=p>(</span><span class=nx>server</span><span class=p>,</span> <span class=nx>database</span><span class=p>,</span> <span class=nx>userName</span><span class=p>,</span> <span class=nx>password</span><span class=p>,</span>
            <span class=kd>function</span> <span class=p>(</span><span class=nx>errorString</span><span class=p>)</span> <span class=p>{</span>
            <span class=nx>alert</span><span class=p>(</span><span class=nx>errorString</span><span class=p>);</span>
        <span class=p>});</span>
    <span class=p>},</span> <span class=kc>false</span><span class=p>);</span>
<span class=p>});</span>
</code></pre></div><p>When the GeotabApi object has been set up, the first call to a method will trigger the callback to get the credentials. Once the credentials have been entered by the user, the authenticationCallback will be called with the entered credentials. Then the original method result will then be retrieved. After this method has been called, the server, database, username, and session are stored in localStorage.</p><h2 id=using-the-geotabapi-object>Using the GeotabApi object</h2><p>The following example demonstrates how to use the GeotabApi object to request the location of a vehicle.</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=c1>// Sample API invocation retrieves all "Device" objects</span>
<span class=kd>var</span> <span class=nx>deviceId</span> <span class=o>=</span> <span class=s2>"b93B"</span><span class=p>;</span> 
<span class=nx>api</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=s2>"Get"</span><span class=p>,</span> <span class=p>{</span>
    <span class=na>typeName</span> <span class=p>:</span> <span class=s2>"DeviceStatusInfo"</span><span class=p>,</span>
    <span class=na>search</span> <span class=p>:</span> <span class=p>{</span>
        <span class=na>deviceSearch</span> <span class=p>:</span> <span class=p>{</span>
            <span class=na>id</span> <span class=p>:</span> <span class=nx>deviceId</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>},</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>result</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=nx>result</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=nx>result</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>alert</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>result</span><span class=p>[</span><span class=mi>0</span><span class=p>]));</span>
    <span class=p>}</span>
<span class=p>},</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>errorString</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>alert</span><span class=p>(</span><span class=nx>errorString</span><span class=p>);</span>
<span class=p>});</span>
</code></pre></div><h2 id=the-call-method-arguments>The Call method arguments</h2><p>The Call method is used to &ldquo;Call&rdquo; any of the APIs that the MyGeotab SDK provides. It takes 4 arguments:</p><table><thead><tr><th><strong>Argument</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td>method</td><td>The API method that is being called. For example, &ldquo;Get&rdquo; or “GetCountOf”. See the API reference for the full set of methods.</td></tr><tr><td>params</td><td>The parameter object that the API method expects. For example: <code>{ typeName: &quot;DeviceStatusInfo&quot;, search { deviceSearch: { id: deviceId } }</code></td></tr><tr><td>callbackSuccess</td><td>The function that will be called back when the API call succeeds. The callback function has a single argument called “result” that will contain any results returned by the API call.</td></tr><tr><td>callbackError</td><td>The function that will be called back should the API call fail. The callback function has a single argument that will contain error information.</td></tr></tbody></table><h2 id=a-note-about-state>A note about state</h2><p>The GeotabApi object is designed to be stateless. The main reason for this is that a call could fail at any point due to session expiry or the database moving. The authenticationCallback will automatically be called when this situation is detected. The application will then prompt (or read from file etc.) for the required credentials. The call that was being attempted will resume when new credentials are received. This also means that there is no concept of being &ldquo;logged in&rdquo; or “out” of the server.</p><h1 id=working-with-jsonp>Working with JSONP</h1><p>Creating a <a href=http://en.wikipedia.org/wiki/JSONP>JSONP</a> request is similar to creating a HTTP GET request — but with one minor change. An additional parameter that specifies the callback in the requested URL will be required to be passed as follows:</p><p><code>https://my.geotab.com/apiv1/GetVersion?JSONP=jsonpCallback</code></p><p>The response will be in the following format with your current version number:</p><div class=highlight><pre><code class=language-json data-lang=json><span class=p>{</span><span class=s2>"result"</span><span class=p>:</span><span class=s2>"5.7.1508.414"</span><span class=p>}</span><span class=w>
</span></code></pre></div><p>In a JavaScript application a function to handle the JSONP callback will need to be set up.</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=nb>window</span><span class=p>.</span><span class=nx>jsonpCallback</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>result</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>alert</span><span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>result</span><span class=p>);</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
        <span class=nx>alert</span><span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>error</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>};</span>
</code></pre></div><p>When the examples are downloaded, the GeotabApi object has an option to use JSONP requests. In this way the examples can be run without placing them on a Web server.</p><h1 id=next-steps>Next steps</h1><p>Once you have a basic understanding of how <em>api.js</em> and the JavaScript API work and want to learn more, you can take a look at our examples <a href=/software/examples/javascript>here</a>.</p></div></article></main></div></div><script src=/sdk/assets/javascript/index-10d8b89f6e.min.js></script></body></html>