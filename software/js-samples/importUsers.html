<!DOCTYPE html><html lang=en><head><meta charset=utf-8><title>Geotab SDK | Import users</title><link href=css/geotab.css rel=stylesheet type=text/css><link href=https://cdnjs.cloudflare.com/ajax/libs/chosen/1.1.0/chosen.min.css rel=stylesheet type=text/css></head><body><header><div class=container><nav><img src=https://gogwebp01.geotab.com/webimages/header/geotablogo.png alt=""> <button id=template>Template</button>&nbsp;&nbsp; <button id=help>Help</button> <button id=signout>Sign out</button></nav><h1>Import users</h1><h3>Creates new users from a comma separated list</h3></div></header><div class="container bordered"><div id=signin-content></div><div id=example-content><form><h3>Import users</h3><p><label for=import-userName>Email or username</label> <input id=import-userName placeholder=user@geotab.com maxlength=255></p><p><label for=import-firstName>Full name</label> <input id=import-firstName placeholder=John maxlength=255> <input id=import-lastName placeholder=Smith maxlength=255></p><p><label for=import-password>Password</label> <input id=import-password type=password placeholder="Minimum of 8 characters" maxlength=255> <label style="font-size: 14px; margin-top: 10px;"><input id=import-password-reset style=float:none type=checkbox title="This user will need to enter a new password the first time they log in to the database.">Force password change on next login</label></p><p><label for=import-groups>Groups</label> <select id=import-groups multiple data-placeholder="Select groups"></select></p><p><label for=import-securityClearance>Security clearance</label> <select id=import-securityClearance></select></p><p><label for=import-nfcKey>Driver key (optional)</label> <input id=import-nfcKey placeholder="NFC key number"> <input id=import-customNFC placeholder="Custom NFC key number"></p><p><label for=import-employeeNumber>Employee number</label> <input id=import-employeeNumber maxlength=255></p><p></p><div class=checkmateField><label class=label>Fuel economy measurement:</label><div id=options_fuelEconomySelect><input type=radio name=fuelButton value=LitersPer100Km id=Lper100km> <label>L/100 km</label><input type=radio name=fuelButton value=KmPerLiter id=kmperL> <label>km/L</label><input type=radio name=fuelButton value=MPGUS id=mpgUS> <label>MPG (US)</label><input type=radio name=fuelButton value=MPGImperial id=mpgImp> <label>MPG (Imp)</label></div></div><p></p><p></p><div class=checkmateField><label class=label>Distance measurement system:</label><div id=options_measurementSelect><input type=radio name=distanceunits value=Metric id=metricUnit> <label>Metric</label> <input type=radio name=distanceunits value=US id=usUnit> <label>US/Imperial</label></div></div><p></p><p></p><div class=checkmateField><label class=label>Feature preview:</label><div><input type=radio name=featurePreviewRadioButton value=On id=idFeaturePreviewOn> <label>On</label> <input type=radio name=featurePreviewRadioButton value=Off id=idFeaturePreviewOff> <label>Off</label></div></div><p></p><p><label for=options_userTimeZoneOffset>Time zone:</label> <select id=options_userTimeZoneOffset></select></p><button type=button class=clickable-heading>Click me to toggle HOS fields:</button><ul style=display:none><p></p><div class=checkmateField><label for=options_AuthorityName>Authority name:</label> <input id=options_AuthorityName class=checkmateFormEditField title="The motor carrier that the driver works for."></div><p></p><p></p><div class=checkmateField><label for=options_AuthorityAddress>Authority address:</label> <input id=options_AuthorityAddress class=checkmateFormEditField title="The motor carrier's main office address."></div><p></p><p></p><div class=checkmateField><label for=options_CarrierNumber>Carrier number:</label> <input id=options_CarrierNumber class=checkmateFormEditField title="In the United States, this is the motor carrier's USDOT number. In Canada, this is the Canadian Carrier code."></div><p></p><p></p><div class=checkmateField><label for=options_Name>Home terminal:</label> <input id=options_Name class=checkmateFormEditField title="The motor carrier's place of business where the driver ordinarily reports for work. This can include a temporary work site designated by the motor carrier."></div><p></p><p></p><div class=checkmateField><label for=options_Address>Home terminal address:</label> <input id=options_Address class=checkmateFormEditField title="The motor carrier's address where the driver ordinarily reports for work."></div><p></p><p></p><div class=checkmateField><label for=options_LicenseNumber>Driver license number:</label> <input id=options_LicenseNumber class=checkmateFormEditField maxlength=1000 title="Driver's license number and License state/province must be set at the same time."></div><p></p><p></p><div class=checkmateField><label class=label>License state/province:</label><div class="flexible set-2x buttonSet horizontalButtonSet adjustableButtonSet" id=options_licenseStateSelect title="Selecting North America will show a dropdown menu; selecting Other will display a text box."><input type=radio onclick=yesnoCheck(); name=licenseStateRadioButton value="North America" id=idLicenseStateNA><label class="geotabButton switcherItem_Metric" for=idLicenseStateNA>North America</label><input type=radio onclick=yesnoCheck(); name=licenseStateRadioButton value=Other id=idLicenseStateOther><label class="geotabButton switcherItem_US" for=idLicenseStateOther>Other</label></div></div><p></p><p></p><div id=ifYes style=display:none><div class=regionInputContainer><input class="checkmateFormEditField regionInput otherRegionInput" style="display: none;"> <select id=options_licenseProvince class=checkmateFormEditField><option value=AG>Aguascalientes</option><option value=AL>Alabama</option><option value=AK>Alaska</option><option value=AB>Alberta</option><option value=AS>American Samoa</option><option value=AZ>Arizona</option><option value=AR>Arkansas</option><option value=BN>Baja California Norte</option><option value=BS>Baja California Sur</option><option value=BC>British Columbia</option><option value=CA>California</option><option value=CP>Campeche</option><option value=CS>Chiapas</option><option value=CI>Chihuahua</option><option value=CH>Coahuila</option><option value=CL>Colima</option><option value=CO>Colorado</option><option value=CT>Connecticut</option><option value=DE>Delaware</option><option value=DC>Dist of col</option><option value=DF>Districto Federal</option><option value=DG>Durango</option><option value=FL>Florida</option><option value=GA>Georgia</option><option value=GU>Guam</option><option value=GJ>Guanajuato</option><option value=GE>Guerrero</option><option value=HI>Hawaii</option><option value=HD>Hidalgo</option><option value=ID>Idaho</option><option value=IL>Illinois</option><option value=IN>Indiana</option><option value=IA>Iowa</option><option value=JA>Jalisco</option><option value=KS>Kansas</option><option value=KY>Kentucky</option><option value=LA>Louisiana</option><option value=ME>Maine</option><option value=MB>Manitoba</option><option value=MD>Maryland</option><option value=MA>Massachusetts</option><option value=MX>Mexico</option><option value=MI>Michigan</option><option value=MC>Michoacan</option><option value=MN>Minnesota</option><option value=MS>Mississippi</option><option value=MO>Missouri</option><option value=MT>Montana</option><option value=MR>Morelos</option><option value=NA>Nayarit</option><option value=NE>Nebraska</option><option value=NV>Nevada</option><option value=NB>New Brunswick</option><option value=NH>New Hampshire</option><option value=NJ>New Jersey</option><option value=NM>New Mexico</option><option value=NY>New York</option><option value=NF>Newfoundland</option><option value=NC>North Carolina</option><option value=ND>North Dakota</option><option value=MP>Northern Marianas</option><option value=NT>Northwest Territories</option><option value=NS>Nova Scotia</option><option value=NL>Nuevo Leon</option><option value=OA>Oaxaca</option><option value=OH>Ohio</option><option value=OK>Oklahoma</option><option value=ON>Ontario</option><option value=OR>Oregon</option><option value=PA>Pennsylvania</option><option value=PE>Prince Edward Island</option><option value=PU>Puebla</option><option value=PR>Puerto Rico</option><option value=QC>Quebec</option><option value=QE>Queretaro</option><option value=QI>Quintana Roo</option><option value=RI>Rhode Island</option><option value=SL>San Luis Potosi</option><option value=SK>Saskatchewan</option><option value=SI>Sinaloa</option><option value=SO>Sonora</option><option value=SC>South Carolina</option><option value=SD>South Dakota</option><option value=TB>Tabasco</option><option value=TA>Tamaulipas</option><option value=TN>Tennessee</option><option value=TX>Texas</option><option value=TL>Tlaxcala</option><option value=UT>Utah</option><option value=VC>Veracruz</option><option value=VT>Vermont</option><option value=VI>Virgin Islands</option><option value=VA>Virginia</option><option value=WA>Washington</option><option value=WV>West Virginia</option><option value=WI>Wisconsin</option><option value=WY>Wyoming</option><option value=YU>Yucatan</option><option value=YT>Yukon Territory</option><option value=ZA>Zacatecas</option></select></div></div><p></p><p></p><div id=ifNo style=display:none><div class=checkmateField><input id=options_LicenseStateOther class=checkmateFormEditField maxlength=1000></div></div><p></p><p></p><div class=checkmateField><label for=options_hosRuleSet>Ruleset:</label> <select id=options_hosRuleSet class=checkmateFormEditField title="This is the ruleset the user will follow when using hours of service."><option value=""></option>"Please select a ruleset"<option value=HosRuleSetAlaskaPassenger7Day>Alaska Passenger 70-hour/7-day</option><option value=HosRuleSetAlaskaPassenger8Day>Alaska Passenger 80-hour/8-day</option><option value=HosRuleSetAlaskaProperty7Day>Alaska Property 70-hour/7-day</option><option value=HosRuleSetAlaskaProperty8Day>Alaska Property 80-hour/8-day</option><option value=HosRuleSetAmerica7Day>USA Property 60-hour/7-day</option><option value=HosRuleSetAmerica7DayBig>USA Property 60-hour/7-day (16-hour exemption)</option><option value=HosRuleSetAmerica7DayNo34h>USA Property 60-hour/7-day without 34-hour restart</option><option value=HosRuleSetAmerica7DayPassenger>USA Passenger 60-hour/7-day</option><option value=HosRuleSetAmerica8Day>USA Property 70-hour/8-day</option><option value=HosRuleSetAmerica8DayBig>USA Property 70-hour/8-day (16-hour exemption)</option><option value=HosRuleSetAmerica8DayNo34h>USA Property 70-hour/8-day without 34-hour restart</option><option value=HosRuleSetAmerica8DayPassenger>USA Passenger 70-hour/8-day</option><option value=HosRuleSetAmericaNoRestRequirement7Day>USA Property 60-hour/7-day without rest requirement</option><option value=HosRuleSetAmericaNoRestRequirement7DayBig>USA Property 60-hour/7-day (16-hour exemption) without rest requirement</option><option value=HosRuleSetAmericaNoRestRequirement8Day>USA Property 70-hour/8-day without rest requirement</option><option value=HosRuleSetAmericaNoRestRequirement8DayBig>USA Property 70-hour/8-day (16-hour exemption) without rest requirement</option><option value=HosRuleSetAmericaNonCdlShortHaul7Day>Non-CDL Short-haul 60-hour/7-day</option><option value=HosRuleSetAmericaNonCdlShortHaul8Day>Non-CDL Short-haul 70-hour/8-day</option><option value=HosRuleSetAmericaSalesperson>USA Salesperson</option><option value=HosRuleSetAmericaShortHaul>USA Property Short-haul 60-hour/7-day 12hr Workday</option><option value=HosRuleSetAmericaShortHaul8Day>USA Property Short-haul 70-hour/8-day 12hr Workday</option><option value=HosRuleSetAmericaShortHaul8DayNo34h>USA Property Short-haul 70-hour/8-day without 34-hour restart</option><option value=HosRuleSetAmericaShortHaulNo34h>USA Property Short-haul 60-hour/7-day without 34-hour restart</option><option value=HosRuleSetAmericaShortHaulPassenger>USA Passenger Short-haul 60-hour/7-day</option><option value=HosRuleSetAmericaShortHaulPassenger8Day>USA Passenger Short-haul 70-hour/8-day</option><option value=HosRuleSetAmericaTexas>Texas Intrastate</option><option value=HosRuleSetAmericaTexasShortHaul>Texas Short-haul 60-hour/7-day Intrastate</option><option value=HosRuleSetAmericaTexasShortHaul8Day>Texas Short-haul 70-hour/8-day Intrastate</option><option value=HosRuleSetBrazilShortHaul>Brazil Property Short-haul</option><option value=HosRuleSetCalifornia8day>California Property Intrastate with rest requirement</option><option value=HosRuleSetCaliforniaFarmProduct>California Farm Product</option><option value=HosRuleSetCaliforniaFlammableLiquid>California Flammable Liquid</option><option value=HosRuleSetCaliforniaPassenger>California Passenger Intrastate</option><option value=HosRuleSetCaliforniaProperty>California Property Intrastate</option><option value=HosRuleSetCaliforniaSchoolPupil>California School Pupil</option><option value=HosRuleSetCanadaCycleOne>Canada 7-Day Cycle 1</option><option value=HosRuleSetCanadaCycleTwo>Canada 14-Day Cycle 2</option><option value=HosRuleSetCarrierExemption>Carrier Exemption</option><option value=HosRuleSetFlorida7Day>USA Florida 70-hour/7-Day</option><option value=HosRuleSetFlorida8Day>USA Florida 80-hour/8-Day</option><option value=HosRuleSetFloridaShortHaul7Day>USA Florida Short-haul 70-hour/7-Day</option><option value=HosRuleSetFloridaShortHaul8Day>USA Florida Short-haul 80-hour/8-Day</option><option value=HosRuleSetMarylandShortHaul7Day>Maryland Short Haul 70-hour/7-day</option><option value=HosRuleSetMarylandShortHaul8Day>Maryland Short Haul 80-hour/8-day</option><option value=HosRuleSetNebraska7day>Nebraska 70-hour/7-day</option><option value=HosRuleSetNebraska8day>Nebraska 80-hour/8-day</option><option value=HosRuleSetNone>No Ruleset (7-day cycle)</option><option value=HosRuleSetNone8Day>No Ruleset (8-day cycle)</option><option value=HosRuleSetNorthDakota7Day>North Dakota 70-hour/7-day</option><option value=HosRuleSetNorthDakotaShortHaul7Day>North Dakota Short Haul 70-hour/7-day</option><option value=HosRuleSetOilTransport7Day>USA Property 60-hour/7-day 24-hour restart</option><option value=HosRuleSetOilTransport7DayBig>USA Property 60-hour/7-day 24-hour restart (16-hour exemption)</option><option value=HosRuleSetOilTransport8Day>USA Property 70-hour/8-day 24-hour restart</option><option value=HosRuleSetOilTransport8DayBig>USA Property 70-hour/8-day 24-hour restart (16-hour exemption)</option><option value=HosRuleSetOilTransportCalifornia8day>California Oil Transport Property Intrastate with rest requirement</option><option value=HosRuleSetOilTransportNoRestRequirement7Day>USA Oil Transport 60-hour/7-day without rest requirement</option><option value=HosRuleSetOilTransportNoRestRequirement7DayBig>USA Oil Transport 60-hour/7-day (16-hour exemption) without rest requirement</option><option value=HosRuleSetOilTransportNoRestRequirement8Day>USA Oil Transport 70-hour/8-day without rest requirement</option><option value=HosRuleSetOilTransportNoRestRequirement8DayBig>USA Oil Transport 70-hour/8-day (16-hour exemption) without rest requirement</option><option value=HosRuleSetOilTransportShortHaul>USA Property Short-haul 60-hour/7-day 12hr Workday 24-hour restart</option><option value=HosRuleSetOilTransportShortHaul8Day>USA Property Short-haul 70-hour/8-day 12hr Workday 24-hour restart</option><option value=HosRuleSetOilTransportTexas>USA Texas Oil Transport 70-hour/7-day</option><option value=HosRuleSetOilWell7Day>USA Oil Well 60-hour/7-day</option><option value=HosRuleSetOilWell7DayBig>USA Oil Well 60-hour/7-day (16-hour exemption)</option><option value=HosRuleSetOilWell8Day>USA Oil Well 70-hour/8-day</option><option value=HosRuleSetOilWell8DayBig>USA Oil Well 70-hour/8-day (16-hour exemption)</option><option value=HosRuleSetOilWellCalifornia8day>California Oil Well Property Intrastate with rest requirement</option><option value=HosRuleSetOilWellNoRestRequirement7Day>USA Oil Well 60-hour/7-day without rest requirement</option><option value=HosRuleSetOilWellNoRestRequirement7DayBig>USA Oil Well 60-hour/7-day (16-hour exemption) without rest requirement</option><option value=HosRuleSetOilWellNoRestRequirement8Day>USA Oil Well 70-hour/8-day without rest requirement</option><option value=HosRuleSetOilWellNoRestRequirement8DayBig>USA Oil Well 70-hour/8-day (16-hour exemption) without rest requirement</option><option value=HosRuleSetOilWellTexas>USA Texas Oil Well 70-hour/7-day</option><option value=HosRuleSetOregon7day>Oregon 70-hour/7-day</option><option value=HosRuleSetOregon8day>Oregon 80-hour/8-day</option><option value=HosRuleSetSouthCarolina7Day>South Carolina 70-hour/7-day</option><option value=HosRuleSetSouthCarolina8Day>South Carolina 80-hour/8-day</option></select></div><p></p><p></p><div class=checkmateField><label class=label>Yard move allowed:</label><div class="flexible set-2x buttonSet horizontalButtonSet adjustableButtonSet" id=options_yardModeSelect title="Toggling this setting to ON allows the driver to apply the yard move exemption."><input type=radio name=yardMoveRadioButton value=On id=idYardMoveOn><label class="geotabButton switcherItem_Metric" for=idYardMoveOn>On</label><input type=radio name=yardMoveRadioButton value=Off id=idYardMoveOff><label class="geotabButton switcherItem_US" for=idYardMoveOff>Off</label></div></div><p></p><p></p><div class=checkmateField><label class=label>Personal conveyance allowed:</label><div class="flexible set-2x buttonSet horizontalButtonSet adjustableButtonSet" id=options_personalConveyanceSelect title="Toggling this setting to ON allows the driver to apply the personal conveyance exemption."><input type=radio name=personalConveyanceRadioButton value=On id=idPersonalConveyanceOn><label class="geotabButton switcherItem_Metric" for=idPersonalConveyanceOn>On</label><input type=radio name=personalConveyanceRadioButton value=Off id=idPersonalConveyanceOff><label class="geotabButton switcherItem_US" for=idPersonalConveyanceOff>Off</label></div></div><p></p></ul><p><button id=addUser>Add user</button>&nbsp;&nbsp;<button id=importUsers disabled>Import users</button>&nbsp;&nbsp;<button type=button id=clear onclick=ClearFields();>Clear</button></p><p><textarea id=content cols=80 rows=8></textarea></p></form></div></div><footer><div class="container footernotes"><p>Source code provided as part of the <a href=https://helpdesk.geotab.com/forums target=_blank>Geotab SDK</a>.</p><p>Last updated on 07/16/2020</p></div></footer><div id=template-content><h2>Template</h2><p>To make things easier, we've provided you with an <a href=templates/import-users-template.xlsx target=_blank>excel template</a>. Please follow the input requirements outlined in the Help menu.<br><br>Keep in mind that Time Zone is a required input and if a license plate is entered, it must be unique to the database. License state is required only if a license plate is provided. You may enter a state other than those provided.<br><br>NFC and Custom NFC keys must be unique to the database; no duplicates can exist.<br></p><div class=code><pre>Email1,FirstName,LastName,Password,GroupName1|GroupName2|...|GroupNameN,SecurityClearanceId,NfcKey,CustomNfcKey,EmployeeNumber,FuelEconomyMeasurement,DistanceMeasurementSystem,FeaturePreview,TimeZone,AuthorityName,AuthorityAddress,CarrierNumber,HomeTerminal,HomeTerminalAddress,DriverLicenseNumber,LicenseState,Ruleset,YardMoveAllowed,PersonalConveyanceAllowed<br>Email2,FirstName,LastName,Password,GroupName1|GroupName2|...|GroupNameN,SecurityClearanceId,NfcKey,,EmployeeNumber,,,,TimeZone,AuthorityName,AuthorityAddress,CarrierNumber,HomeTerminal,HomeTerminalAddress,DriverLicenseNumber,LicenseState,Ruleset,YardMoveAllowed,PersonalConveyanceAllowed<br>Email3,FirstName,LastName,Password,GroupName1|GroupName2|...|GroupNameN,SecurityClearanceId,NfcKey,,,,,,,,,,,,,,Ruleset,,</pre></div></div><div id=help-content><h2>Help</h2><p>This SDK example assists with importing users to your database using comma separated values (CSV).</p><p>Use the form to add new users with optional NFC or GO driver keys. You can also use the text box to paste in users from another source.<table><thead><tr><th>Value</th><th>Example</th><th>Notes</th></tr></thead><tbody><tr><td>Email</td><td>john.smith@geotab.com</td><td>Can be email or user name. Spaces are not allowed.</td></tr><tr><td>First name</td><td>John</td><td>Spaces are not allowed.</td></tr><tr><td>Last name</td><td>Smith</td><td></td></tr><tr><td>Password</td><td></td><td>Minimum of 6 characters.</td></tr><tr><td>Groups</td><td>Drivers|West|Garmin</td><td>Names of groups separated by the | character.</td></tr><tr><td>Security clearance ID</td><td>b28A7</td><td>Found in the URL when viewing a security clearance in MyGeotab.<br><br>Example:<br>my.geotab.com/DATABASE/#clearance,id:<strong>b28A7</strong></td></tr><tr><td>NFC key number</td><td>T1234S</td><td><i>Optional</i>. Found on the NFC key fob.</td></tr><tr><td>Custom NFC key number</td><td>12345678</td><td><i>Optional</i>. Found on the Custom NFC key fob.</td></tr><tr><td>Employee number</td><td>63-221-44</td><td><i>Optional</i>. The user's employee number.</td></tr><tr><td>Fuel economy measurement</td><td>LitersPer100Km</td><td><i>Optional</i>. Choose how to display fuel economy. There are four different measurements: liters per 100 kilometers, kilometers per liter, miles per US gallon, or miles per imperial gallon. You may need to refresh your browser for the change to take effect.</td></tr><tr><td>Distance measurement system</td><td>Metric (true)</td><td><i>Optional</i>. Choose how to display speeds and distances. This can be Metric or US/Imperial. You may need to refresh your browser to see the change take effect.</td></tr><tr><td>Feature preview</td><td>On or Off (true or false)</td><td><i>Optional</i>. Toggle feature preview.</td></tr><tr><td>Time zone</td><td>America/New_York</td><td>The time zone offset from UTC for your location. All data will be displayed in this time zone.</td></tr><tr><td>Authority name</td><td>National Express</td><td><i>Optional</i>. The motor carrier that the driver works for.</td></tr><tr><td>Authority address</td><td>5000 Explorer Drive</td><td><i>Optional</i>. The motor carrier's main office address.</td></tr><tr><td>Carrier number</td><td>8Z88</td><td><i>Optional</i>. In the United States, this is the motor carrier's USDOT number. In Canada, this is the Canadian Carrier code.</td></tr><tr><td>Home terminal</td><td>Stark Tower</td><td><i>Optional</i>. The motor carrier's place of business where the driver ordinarily reports for work. This can include a temporary work site designated by the motor carrier.</td></tr><tr><td>Home terminal address</td><td>200 Park Avenue</td><td><i>Optional</i>. The motor carrier's address where the driver ordinarily reports for work.</td></tr><tr><td>Driver license number</td><td>YEET</td><td><i>Optional</i>. Driver's license number and License state/province must be set at the same time.</td></tr><tr><td>License state/province</td><td>Ontario (ON)</td><td><i>Optional</i>. Selecting North America will show a dropdown menu; selecting Other will display a text box.</td></tr><tr><td>Ruleset</td><td>California Property Intrastate (HosRuleSetCaliforniaProperty)</td><td><i>Optional</i>. This is the ruleset the user will follow when using hours of service.</td></tr><tr><td>Yard move allowed</td><td>On or Off (true or false)</td><td><i>Optional</i>. Toggling this setting to ON allows the driver to apply the yard move exemption.</td></tr><tr><td>Personal conveyance allowed</td><td>On of Off (true or false)</td><td><i>Optional</i>. Toggling this setting to ON allows the driver to apply the personal conveyance exemption.</td></tr></tbody></table></p></div><script src=js/api.js></script><script src=js/login.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/chosen/1.1.0/chosen.jquery.min.js></script><script type=text/javascript>var groupCache = {};
            var securityClearanceCache = {};
			var selectedGroups = [];
			var passwordResetCheckbox = document.getElementById("import-password-reset");
			var hosRulesetArray = [];
			var moreCalls = [];

			function toggleDocs(event) {

				if (event.target && event.target.className == 'clickable-heading') {

					var next = event.target.nextElementSibling;


					if (next.style.display == "none") {
						next.style.display = "block";

					} else {
						next.style.display = "none";
					}
				}
			}

			function yesnoCheck() {
    			if (document.getElementById('idLicenseStateNA').checked) {
					document.getElementById('ifYes').style.display = 'block';
					document.getElementById('ifNo').style.display = 'none';
    			}
				else {
					document.getElementById('ifYes').style.display = 'none';
					document.getElementById('ifNo').style.display = 'block';
				}
			}

			document.addEventListener('click', toggleDocs, true);

            document.addEventListener("DOMContentLoaded", function() {

                groupCache = refreshGroupCache(null);
				securityClearanceCache = refreshSecurityClearanceCache(null);
				timeZoneCache = refreshTimeZoneCache(null);
				
				
				document.getElementById("content").addEventListener("keyup", function(event) {
					event.preventDefault();
					
					document.getElementById("importUsers").disabled = (event.target.value === "");
				});
				
				$("#import-groups").on("change", function(event, parameters) {
					if (parameters.selected) {
						selectedGroups.push(parameters.selected);
					} else {
						var index = selectedGroups.indexOf(parameters.deselected);
						if (index > -1) {
							selectedGroups.splice(index, 1);
						}
					}
				});

				
				document.getElementById("addUser").addEventListener("click", function(event) {
					event.preventDefault();
					
					var user = parseUserFromFields();
					
					if (user.userName === "") {
						alert("Email or user name is required");
						return;
					}
					if (user.userName.indexOf(" ") >= 0) {
						alert("Email or user name cannot contain a space");
						return;
					}
					if (user.firstName === "") {
						alert("First name is required");
						return;
					}
					if (user.lastName === "") {
						alert("Last name is required");
						return;
					}
					if (!$(passwordResetCheckbox).is(":checked") && user.password === "") {
						alert("Password is required");
						return;
					}
					if (user.groups.length <= 0) {
						alert("User must belong to at least one group");
						return;
					}
					if (user.securityClearance === "") {
						alert("Security clearance is required");
						return;
					}
					if (isNaN(user.customNfcKey) || user.customNfcKey < 0 || user.customNfcKey > 72057594037927940) {
						alert("Custom NFC Key Serial Number must be between 0 and 72057594037927940");
						return;
					}
					
					var newContent = document.getElementById("content").value;
					
					if (newContent !== "") {
						newContent += "\n";
					}
					newContent += user.userName + ",";
					newContent += user.firstName + ",";
					newContent += user.lastName + ",";
					newContent += user.password + ",";
					for (var i = 0; i < user.groups.length; i++) {
						if (i < user.groups.length - 1) {
							newContent += user.groups[i] + "|";
						} else {
							newContent += user.groups[i] + ",";
						}
					}
					newContent += user.securityClearance + ",";
					newContent += user.nfcKey + ",";
					newContent += user.customNfcKey + ",";
					newContent += user.employeeNo + ",";
					newContent += user.fuelEconomyUnit + ",";
					newContent += user.isMetric + ",";
					newContent += user.isLabsEnabled + ",";
                    newContent += user.timeZoneId + ",";
                    newContent += user.authorityName + ",";
                    newContent += user.authorityAddress + ",";
                    newContent += user.carrierNumber + ",";
                    newContent += user.companyName + ",";
                    newContent += user.companyAddress + ",";
                    newContent += user.licenseNumber + ",";
                    newContent += user.licenseProvince + ",";
                    newContent += user.hosRuleSet + ",";
					newContent += user.isYardMoveEnabled + ",";
					newContent += user.isPersonalConveyanceEnabled;
					
					document.getElementById("content").value = newContent;
					document.getElementById("importUsers").disabled = false;
				});

                document.getElementById("importUsers").addEventListener("click", function(event) {
                    event.preventDefault();

                    hosRulesetArray = [];

                    var content = document.getElementById("content").value;

                    if (content === "") {
                        alert("At least one user is required");
                    } else {
                        var userRows = content.split("\n");
						
						var users = [];
						
						for (var i = 0; i < userRows.length; i++) {
							if (userRows[i].trim() !== "") {
								users.push(userRows[i].trim());
							}
						}
						
                        var calls = [];
                        var userListAndRuleset = [];
						
                        for (i = 0; i < users.length; i++) {
                            var split = users[i].split(",");

                            if (split.length !== 23) {
                                alert("Missing necessary information from user: " + users[i]);
                                continue;
                            }

                            var userName = split[0];
                            var firstName = split[1];
                            var lastName = split[2];
                            var password = split[3];
                            var groups = parseGroups(split[4]);
                            var securityGroups = parseSecurityClearanceName(split[5]);
							var keys = parseKeys(split[6], split[7]);
							var employeeNo = split[8];
							var fuelEconomyUnit = split[9];
							var isMetric = split[10];
							var isLabsEnabled = split[11];
                            var timeZoneId = split[12];
                            var authorityName = split[13];
                            var authorityAddress = split[14];
                            var carrierNumber = split[15];
                            var companyName = split[16];
                            var companyAddress = split[17];
                            var licenseNumber = split[18];
                            var licenseProvince = split[19];    
                            var hosRuleSet = split[20];
							var isYardMoveEnabled = split[21];
							var isPersonalConveyanceEnabled = split[22]; 

   
							
							var newUser = {
										name: userName,
										firstName: firstName,
										lastName: lastName,
										password: password,
										companyGroups: groups,
										securityGroups: securityGroups,
										userAuthenticationType: "BasicAuthentication",
										activeFrom: new Date().toISOString(),
										activeTo: "2050-01-01T00:00:00.000Z",
										employeeNo: employeeNo,
										fuelEconomyUnit: fuelEconomyUnit,
										isMetric: isMetric,
										isLabsEnabled: isLabsEnabled,
                                        timeZoneId: timeZoneId,
                                        authorityName: authorityName,
                                        authorityAddress: authorityAddress,
                                        carrierNumber: carrierNumber,
                                        companyName: companyName,
                                        companyAddress: companyAddress,
                                        licenseNumber: licenseNumber,
                                        licenseProvince: licenseProvince,
										isYardMoveEnabled: isYardMoveEnabled,
										isPersonalConveyanceEnabled: isPersonalConveyanceEnabled
									};

							if (keys.length > 0){
								newUser.driverGroups =  groups;
								newUser.viewDriversOwnDataOnly =  false;
								newUser.keys = keys;
								newUser.isDriver = true;
                            }
                            if (licenseNumber.length > 0){
                                newUser.driverGroups =  groups;
								newUser.viewDriversOwnDataOnly =  false;
                                newUser.isDriver = true;
                            }
							if ($(passwordResetCheckbox).is(":checked"))
							{
								newUser.changePassword = true;
                            }
                            
							hosRulesetArray.push(hosRuleSet);
							
							calls.push([
								"Add", {
									typeName: "User",
									entity: newUser
								}
							]);                            
                        }
						
						api.multiCall(calls, function(results) {
                            var userIds = results;
							pushRulesets(userIds);
              
							api.multiCall(moreCalls, function(results) {moreCalls = [];}, function(error) {console.log(error); moreCalls = [];});

							if (results !== undefined && results !== null && results.length > 0) {
								alert("Imported " + results.length + " of " + users.length + " users");
							}
						}, function(error) {
							if (error !== undefined && error !== null) {
								if (error.indexOf("checksum") > 0) {
									alert("There was a problem importing users. Please check that the NFC driver keys are entered correctly.");
								} else if (error.indexOf("Index was outside") > 0) {
									alert("There was a problem importing users. Please check that the Custom NFC driver keys are entered correctly.");
								} else if (error.indexOf("DuplicateUserException") > 0) {
									alert("There was a problem importing users. You have attempted to import a user name which already exists on your database.");
								} else if (error.indexOf("DuplicateException") > 0) {
									alert("There was a problem importing users. You have attmepted to import a driver key which already exists on your database.");
								} else {
									console.error(error);
									alert("There was a problem importing users. Please check that all fields are entered correctly, the groups and security clearances still exist on your account and that the email addresses or user names are not currently in use.");
								}
							}
                        });

						var pushRulesets = function (userIds) {
							for (i = 0; i < userIds.length; i++) {

								var anotherUser = {
									dateTime: new Date().toISOString(),
									hosRuleSet: {"id": hosRulesetArray[i]},
									user: {"id": userIds[i]}
								};

								//if no ruleset is selected, do not push one to user
								if (hosRulesetArray[i] !== "") {

								moreCalls.push([
									"Add", {
										typeName: "UserHosRuleSet",
										entity: anotherUser
									}
								]);
								}
							}
						}
                    }
                });

            });
			
			function parseUserFromFields() {
				var groups = [];
			
				for (var i = 0; i < selectedGroups.length; i++) {
					for (var key in groupCache) {
						if (groupCache[key].id == selectedGroups[i]) {
							groups.push(groupCache[key].name);
							break;
						}
					}
				}
				
				var securityClearanceSelect = document.getElementById("import-securityClearance");
				var securityClearanceId = securityClearanceSelect[securityClearanceSelect.selectedIndex].value;

				if (document.getElementById("Lper100km").checked) {
					var fuelEconomySelect = document.getElementById("Lper100km").value;
				} else if (document.getElementById("kmperL").checked) {
					var fuelEconomySelect = document.getElementById("kmperL").value;
				} else if (document.getElementById("mpgUS").checked) {
					var fuelEconomySelect = document.getElementById("mpgUS").value;
				} else if (document.getElementById("mpgImp").checked) {
					var fuelEconomySelect = document.getElementById("mpgImp").value;
				} else {
					var fuelEconomySelect = "";
				}

				if (document.getElementById("metricUnit").checked) {
					var isMetric = true;
				} else if (document.getElementById("usUnit").checked) {
					var isMetric = false;
				} else {
					var isMetric = "";
				}

				if (document.getElementById("idFeaturePreviewOn").checked) {
					var isLabsEnabled = true;
				} else if (document.getElementById("idFeaturePreviewOff").checked) {
					var isLabsEnabled = false;
				} else {
					var isLabsEnabled = "";
				}

				var timeZoneId = document.getElementById("options_userTimeZoneOffset").value;

                if (document.getElementById('idLicenseStateNA').checked) {
                    var plateState = document.getElementById("options_licenseProvince").value;
                } else if (document.getElementById('idLicenseStateOther').checked) {
                    var plateState = document.getElementById("options_LicenseStateOther").value;
                } else {var plateState = ""}

				var selectedHosRuleset = document.getElementById("options_hosRuleSet").value;

				if (document.getElementById("idYardMoveOn").checked) {
					var isYardMoveEnabled = true;
				} else if (document.getElementById("idYardMoveOff").checked) {
					var isYardMoveEnabled = false;
				} else {
					var isYardMoveEnabled = "";
				}

				if (document.getElementById("idPersonalConveyanceOn").checked) {
					var isPersonalConveyanceEnabled = true;
				} else if (document.getElementById("idPersonalConveyanceOff").checked) {
					var isPersonalConveyanceEnabled = false;
				} else {
					var isPersonalConveyanceEnabled = "";
				}       

                return {
					userName: document.getElementById("import-userName").value,
					firstName: document.getElementById("import-firstName").value,
					lastName: document.getElementById("import-lastName").value,
					password: document.getElementById("import-password").value,
					groups: groups,
					securityClearance: securityClearanceId,
					nfcKey: document.getElementById("import-nfcKey").value,
					customNfcKey: document.getElementById("import-customNFC").value,
					employeeNo: document.getElementById("import-employeeNumber").value,
					fuelEconomyUnit: fuelEconomySelect,
					isMetric: isMetric,
					isLabsEnabled: isLabsEnabled,
                    timeZoneId: timeZoneId,
                    authorityName: document.getElementById("options_AuthorityName").value,
                    authorityAddress: document.getElementById("options_AuthorityAddress").value,
                    carrierNumber: document.getElementById("options_CarrierNumber").value,
                    companyName: document.getElementById("options_Name").value,
                    companyAddress: document.getElementById("options_Address").value,
                    licenseNumber: document.getElementById("options_LicenseNumber").value,
                    licenseProvince: plateState,
                    hosRuleSet: document.getElementById("options_hosRuleSet").value,
					isYardMoveEnabled: isYardMoveEnabled,
					isPersonalConveyanceEnabled: isPersonalConveyanceEnabled
				}
			}

            function parseGroups(text) {
                var result = [];
                var split = text.split("|");
                for (var i = 0; i < split.length; i++) {
                    if (groupCache.hasOwnProperty(split[i].trim())) {
                        result.push(groupCache[split[i].trim()]);
                    }
                }
                if (result.length <= 0) {
                    result.push(groupCache["GroupCompanyId"]);
                }
                return result;
            }

            function parseSecurityClearanceName(text) {
                var result = [];
                var split = text.split("|");
                for (var i = 0; i < split.length; i++) {
                    if (securityClearanceCache.hasOwnProperty(split[i].trim())) {
                        result.push(securityClearanceCache[split[i].trim()]);
                    }
                }
                if (result.length <= 0) {
                    result.push(securityClearanceCache["GroupEverythingSecurityId"]);
                }
                return result;
            }

            function parseKeys(nfcKey, customNfcKey) {
                var keys = [];
                if (nfcKey !== "") {
                    keys.push({
                        serialNumber: nfcKey,
                        driverKeyType: "Nfc",
                        isImmobilizeOnly: true
                    });
                }
                if (customNfcKey > 0 && customNfcKey < 72057594037927940) {
                    keys.push({
                        serialNumber: customNfcKey,
                        driverKeyType: "CustomNfc",
                        isImmobilizeOnly: true
                    });
				} 
				else if (customNfcKey === "") {
					// do nothing	
				} 
				else alert("Custom NFC Key Serial Number must be between 0 and 72057594037927940.")
                return keys;
			}

			function refreshTimeZoneCache(callback) {
				var select = document.getElementById("options_userTimeZoneOffset");
			
                api.call("GetTimeZones", {}, function(result) {
                    if (result !== undefined && result != null && result.length > 0) {
                        timeZoneCache = {};

						result.sort(function(a, b) {
							if (a.id.toLowerCase() < b.id.toLowerCase()) {
								return -1;
							}
							if (a.id.toLowerCase() > b.id.toLowerCase()) {
								return 1;
							}
							return 0;
						});
						for (i = 0; i < result.length; i++) {
							timeZoneCache[result[i].id] = result[i];
							var option = new Option();
							option.text = result[i].id;
							option.value = result[i].id;
							select.add(option);
						}
                    }
                    if (callback) {
                        callback();
                    }
                }, function(error) {
                    console.log(error);
                });
            }

            function refreshGroupCache(callback) {
				var select = document.getElementById("import-groups");
			
                api.call("Get", {
                    typeName: "Group"
                }, function(result) {
                    if (result !== undefined && result != null && result.length > 0) {
                        groupCache = {};
                        for (var i = 0; i < result.length; i++) {
                            if (result[i].name === undefined) {
								result[i].name = result[i].id;
                            }
                        }
						result.sort(function(a, b) {
							if (a.name.toLowerCase() < b.name.toLowerCase()) {
								return -1;
							}
							if (a.name.toLowerCase() > b.name.toLowerCase()) {
								return 1;
							}
							return 0;
						});
						for (i = 0; i < result.length; i++) {
							groupCache[result[i].name] = result[i];
							var option = new Option();
							option.text = result[i].name;
							option.value = result[i].id;
							select.add(option);
						}
                    }
					$("#import-groups").chosen({
						search_contains: true
					});
                    if (callback) {
                        callback();
                    }
                }, function(error) {
                    console.log(error);
                });
            }

            function refreshSecurityClearanceCache(callback) {
				var select = document.getElementById("import-securityClearance");
			
                api.call("Get", {
                    typeName: "Group",
                    search: {
                        id: "GroupSecurityId"
                    }
                }, function(result) {
                    if (result !== undefined && result != null && result.length > 0) {
                        securityClearanceCache = {};
                        for (var i = 0; i < result.length; i++) {
                            if (result[i].name === undefined) {
								result[i].name = result[i].id;
                            }
                        }
						result.sort(function(a, b) {
							if (a.name.toLowerCase() < b.name.toLowerCase()) {
								return -1;
							}
							if (a.name.toLowerCase() > b.name.toLowerCase()) {
								return 1;
							}
							return 0;
						});
						for (i = 0; i < result.length; i++) {
							securityClearanceCache[result[i].id] = result[i];
							var option = new Option();
							option.text = result[i].name;
							option.value = result[i].id;
							select.add(option);
						}
                    }
                    if (callback) {
                        callback();
                    }
                }, function(error) {
                    console.log(error);
                });
            }

			function ClearFields() {

			document.getElementById("content").value = "";
			}</script></body></html>